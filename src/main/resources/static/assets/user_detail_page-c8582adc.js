import{a as r,o as f,c as m,b as t,w as l,v as u,k as c,_ as p}from"./index-793f7473.js";import{g,r as h,u as b,a as y}from"./index.esm2017-76f3ad60.js";const x={data(){return{user:{},file:{},id:0}},methods:{getImageUrl(s){const e=s!==null?s:"/src/assets/default-user-profile.png";return new URL(e,import.meta.url).href},isEmptyObject(s){return Object.keys(s).length===0&&s.constructor===Object},onChangeProfileImage(s){const e=s.target.files||s.dataTransfer.files;e!=={}&&(this.file=e[0],this.user.profileUrl=URL.createObjectURL(this.file))},transferPhoneNumberFormat(s){let e="";e=s.target.value.replace(/[^0-9]/g,""),e.length<4?this.user.tel=e:e.length===4?this.user.tel=`${e.slice(0,3)}-${e.slice(3)}`:e.length===7?this.user.tel=`${e.slice(0,3)}-${e.slice(3,7)}-${e.slice(7)}`:this.user.tel=`${e.slice(0,3)}-${e.slice(3,7)}-${e.slice(7,11)}`},async onUserEditing(){if(this.id=this.$route.params.id,this.isEmptyObject(this.file)){const s={email:this.user.email,name:this.user.name,tel:this.user.tel,profileUrl:this.user.profileUrl,role:this.user.role};await r.patch(`${r.defaults.baseURL}api/user/${this.id}`,s,{headers:{"Content-Type":"application/json"}}).then(e=>{console.log(`isEditSucess : ${JSON.stringify(e)}`),e.data.editSuccess&&(alert("해당 사용자 정보가 수정되었습니다."),window.location.reload())}).catch(e=>console.error(`e : ${e}`)).finally(()=>console.log("finally"))}else{const s=g();this.user.profileUrl.slice(this.user.profileUrl.lastIndexOf("/"));const e=h(s,`profiles/${this.id}/${this.file.name}`);b(e,this.file).then(async i=>{const a=await y(i.ref);console.log(`path : ${i.ref}`),this.user.profile_image=i.ref;var n={email:this.user.email,name:this.user.name,tel:this.user.tel,profileUrl:a,role:this.user.role},d=await r.patch(`${r.defaults.baseURL}api/user/${this.id}`,n,{headers:{"Content-Type":"application/json"}});d.data.editSuccess&&(alert("해당 사용자 정보가 수정되었습니다."),window.location.reload())})}},async onUserDeleting(){this.id=this.$route.params.id,(await r.delete(`${r.defaults.baseURL}api/user/${this.id}`)).data.isSuccess&&(this.$store.commit("setUser",{}),alert("해당 사용자가 삭제되었습니다."),this.$router.push("/login"))}},async beforeCreate(){this.id=this.$route.params.id;const s=await r.get(`${r.defaults.baseURL}api/user/${this.id}`);this.user=s.data}},w={class:"w-full m-5"},_={class:"sm:max-w-lg md:max-w-3xl lg:max-w-2xl xl:max-w-6xl",enctype:"multipart/form-data"},v=t("div",{class:"text-lg font-bold"}," 회원 상세보기 ",-1),U={class:"w-full my-5"},$={class:"flex justify-center mr-2"},k={for:"profileUrl",class:"relative cursor-default rounded-md"},R=["src"],j={class:"flex flex-wrap -mx-3 mb-6"},L={class:"w-full px-3"},C=t("label",{class:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",for:"email"}," 이메일 ",-1),E={class:"flex flex-wrap -mx-3 mb-6"},I={class:"w-full md:w-1/2 px-3 mb-6 md:mb-0"},O=t("label",{class:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",for:"name"}," 이름 ",-1),S={class:"w-full md:w-1/2 px-3"},D=t("label",{class:"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2",for:"tel"}," 전화번호 ",-1),N=["value"],V={class:"mt-6 space-y-3"},B=t("div",{class:"block uppercase tracking-wide text-gray-700 text-xs font-bold"}," 권한 ",-1),P={class:"flex items-start"},T={class:"flex items-center gap-x-3 mr-4"},M=t("div",{class:"block text-sm font-medium leading-6 text-gray-900"},"회원",-1),F={class:"flex items-center gap-x-3 mr-4"},A=t("div",{class:"block text-sm font-medium leading-6 text-gray-900"},"관리자",-1),J={class:"mt-6 space-y-3"},q={class:"flex justify-end"};function z(s,e,i,a,n,d){return f(),m("div",w,[t("div",_,[v,t("div",U,[t("div",$,[t("label",k,[t("img",{class:"w-32 h-32 rounded-full",src:s.getImageUrl(s.user.profileUrl)},null,8,R),t("input",{id:"profileUrl",name:"profileUrl",type:"file",class:"sr-only",onChange:e[0]||(e[0]=o=>s.onChangeProfileImage(o))},null,32)])])]),t("div",j,[t("div",L,[C,l(t("input",{class:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500",id:"email",name:"email","onUpdate:modelValue":e[1]||(e[1]=o=>s.user.email=o),disabled:"",autocomplete:"on"},null,512),[[u,s.user.email]])])]),t("div",E,[t("div",I,[O,l(t("input",{class:"appearance-none block w-full bg-gray-200 text-gray-700 border border-grey-200 hover:border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white",id:"name",name:"name","onUpdate:modelValue":e[2]||(e[2]=o=>s.user.name=o),autocomplete:"on"},null,512),[[u,s.user.name]])]),t("div",S,[D,t("input",{class:"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 hover:border-red-500 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white",id:"tel",name:"tel",value:s.user.tel,onInput:e[3]||(e[3]=o=>s.transferPhoneNumberFormat(o)),autocomplete:"on"},null,40,N)])]),t("div",V,[B,t("div",P,[t("div",T,[l(t("input",{name:"role",type:"radio",class:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600","onUpdate:modelValue":e[4]||(e[4]=o=>s.user.role=o),value:"USER"},null,512),[[c,s.user.role]]),M]),t("div",F,[l(t("input",{name:"role",type:"radio",class:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600","onUpdate:modelValue":e[5]||(e[5]=o=>s.user.role=o),value:"ADMIN"},null,512),[[c,s.user.role]]),A])])]),t("div",J,[t("div",q,[t("button",{onClick:e[6]||(e[6]=(...o)=>s.onUserEditing&&s.onUserEditing(...o)),class:"inline-flex justify-center rounded-md border border-transparent bg-blue-500 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-blue-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 mr-2"}," 수정 "),t("button",{onClick:e[7]||(e[7]=(...o)=>s.onUserDeleting&&s.onUserDeleting(...o)),class:"inline-flex justify-center rounded-md border border-transparent bg-red-500 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-900 focus:ring-offset-2"}," 삭제 ")])])])])}const K=p(x,[["render",z]]);export{K as default};
